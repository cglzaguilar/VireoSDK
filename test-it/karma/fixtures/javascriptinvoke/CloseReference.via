define(MyVI dv(VirtualInstrument (
    Locals: c(
        ce(dv(.ErrorCluster (true 100 'error' )) errorIn)
        e(c(e(.Boolean status) e(.Int32 code) e(.String source)) err)
        e(c(e(.Boolean status) e(.Int32 code) e(.String source)) getObjectReferenceError1)
        e(c(e(.Boolean status) e(.Int32 code) e(.String source)) getObjectReferenceError2)

        e(c(e(.Boolean status) e(.Int32 code) e(.String source)) noErrorInAndValidReferenceError)
        e(c(e(.Boolean status) e(.Int32 code) e(.String source)) errorInAndValidReferenceError)
        e(c(e(.Boolean status) e(.Int32 code) e(.String source)) noErrorInAndInvalidReferenceError)
        e(c(e(.Boolean status) e(.Int32 code) e(.String source)) errorInAndInvalidReferenceError)

        e(.JavaScriptDynamicRefNum objectReference)
        e(dv(.Boolean false) isNotAValidRefnum1)
        e(dv(.Boolean false) isNotAValidRefnum2)
        e(dv(.Boolean false) isNotAValidRefnum3)
        e(dv(.Boolean false) isNotAValidRefnum4)
        e(.Occurrence occurrence)
    )
    clump (
        // no error in, valid reference, close reference => no error out, reference closed
        JavaScriptInvoke(occurrence false getObjectReferenceError1 'NI_GetObjectFunction' objectReference)
        CloseReference(objectReference noErrorInAndValidReferenceError)
        IsNotANumPathRefnum(objectReference isNotAValidRefnum1)

        // error in, valid reference, close reference => error out same as error in, reference closed
        JavaScriptInvoke(occurrence false getObjectReferenceError2 'NI_GetObjectFunction' objectReference)
        Copy(errorIn errorInAndValidReferenceError)
        CloseReference(objectReference errorInAndValidReferenceError)
        IsNotANumPathRefnum(objectReference isNotAValidRefnum2)

        // no error in, invalid reference, close reference => invalid reference error
        CloseReference(objectReference noErrorInAndInvalidReferenceError)
        IsNotANumPathRefnum(objectReference isNotAValidRefnum3)

        // error in, invalid reference, close reference => error out same as error in
        Copy(errorIn errorInAndInvalidReferenceError)
        CloseReference(objectReference noErrorInAndInvalidReferenceError)
        IsNotANumPathRefnum(objectReference isNotAValidRefnum4)
    )
) ) )

enqueue(MyVI)
